"""
Purpose: Load, merge, and analyze report datasets generated by different sources/models.

Inputs:
    - JSON files of model/report outputs located in ../data

Outputs:
    - Merged DataFrame
    - Agreement metrics printed to console
    - Optional further analysis per task
"""


import sys
import os
from pathlib import Path

# -----------------------------
# Adjust module path
# -----------------------------
module_dir = "../"  # relative path to your src folder
sys.path.append(os.path.abspath(module_dir))

# -----------------------------
# Import functions
# -----------------------------
from src.eval.prompting import *
from src.eval.evaluation import *

# -----------------------------
# Parameters (easily modifiable)
# -----------------------------
# Dataset names (rs = report source)
rs_list = ["rsdiscovera(gpt-4o)", "rsgroundtruth"]         # Can add more report sources
ans_prefix = "20"                # Can be modified for different answer sets
provider = "openai"              # Provider used
model_name = "gpt-5"             # Model used
data_dir = Path("../data")       # Base data path

# -----------------------------
# Construct file paths dynamically
# -----------------------------
file_paths = [
    data_dir / f"ans{ans_prefix}_{rs}_openai_{model_name}.json"
    for rs in rs_list
]
# -----------------------------
# Load and merge reports
# -----------------------------
df = load_and_merge_reports(file_paths)

# -----------------------------
# Calculate agreement
# -----------------------------
calculate_agreement(df)

# -----------------------------
# Perform further analysis (e.g., per-task agreement)
# -----------------------------
agreement_x_analysis(df)

# -----------------------------
# Optional: print summary
# -----------------------------
print("Analysis complete!")
